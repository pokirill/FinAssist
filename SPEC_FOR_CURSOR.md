# FinAssist — SPEC

## 0. Кратко о продукте

FinAssist — iOS-приложение (SwiftUI) для людей, которые:

- ставят финансовые цели (квартира, поездки, подушка, хотелки),
- получают доход (часто аванс/зарплата + премии),
- хотят понять:
  - сколько можно откладывать на цели в каждый период,
  - когда будут достигнуты цели,
  - когда можно покупать хотелки без вреда для плана,
  - как распределять деньги по «виртуальным вкладам» (конвертам).

Приложение = “честная замена Excel” для личного финансового плана.

---

## 1. Основные сущности

### 1.1. Цель (Goal)

- Поля (логически):
  - id
  - name
  - targetAmount
  - currentAmount
  - targetDate (для всех целей, кроме подушки – желаемая дата)
  - description (опционально)
  - priority:
    - `critical` — критичная (квартира, подушка и т.п.)
    - `important` — важная
    - `niceToHave` — желаемая
  - type:
    - `generic` — обычная цель
    - `cushion` — подушка безопасности
    - `travel` — путешествие (будет обрабатываться отдельно)
- Поведение:
  - все цели участвуют в распределении свободных денег,
  - порядок: `critical → important → niceToHave`, внутри — по ближайшей дате.

### 1.2. Подушка (цель типа `cushion`)

- Всегда реализована как цель `type = cushion`, `priority = critical`.
- Целевая сумма = `средний месячный доход × N месяцев`, N по умолчанию = 3 (настраивается).
- Подушка включается/выключается в настройках:
  - включена → участвует как критичная цель до достижения;
  - достигнута → больше не получает отчислений;
  - выключена → скрывается, накопленная сумма подушки считается “освободившейся” и распределяется по другим целям по приоритетам.
- Возможность пропустить отчисление в подушку **в конкретном периоде** (флаг “в этот период не откладывать”).

### 1.3. Доходы, расходы, кредиты

- Доходы:
  - оклад, возможно разделённый на аванс/зарплату (даты + доли),
  - премии (разовые и регулярные).
- Расходы:
  - категории (жильё, кредиты, коммуналка, продукты, связь, подписки, транспорт и т.д.),
  - суммы по категориям (минимум — ежемесячные).
- Кредиты:
  - ежемесячный платёж,
  - дата платежа,
  - **конечная дата кредита (optional)**:
    - если не указана → расход постоянный;
    - если указана → после этой даты платёж прекращается.

### 1.4. Wishlist (хотелки)

- Отдельная сущность, не цель.
- Поля:
  - id, name, amount, createdAt, (опционально note).
- Не имеет своей даты — система считает ориентировочную дату:  
  “когда можно купить без вреда подушке и целям”.

### 1.5. Виртуальные вклады (конверты)

- Не реальные банковские счета, а модель внутри приложения:
  - `Обязательные платежи`,
  - `Фонд целей`,
  - `Подушка` (когда включена).
- Основной счёт = “кошелёк” на повседневные расходы.
- Приложение даёт рекомендации:
  - сколько в периоде перевести в каждый “вклад”,
  - сколько оставлять в кошельке,
  - как распределяется сумма внутри каждого вклада (по категориям/целям).

---

## 2. Прогноз и распределение

### 2.1. Прогноз по дням

- Прогноз строится **по дням**:
  - считаются события доходов (оклад, премии, кредиты и т.п.),
  - расходы по категориям и кредитам,
  - свободный кэш = доходы − обязательные.
- Для каждой цели определяется **конкретный день**, когда `currentAmount >= targetAmount`.
- Если при текущих доходах/расходах цель недостижима — помечается как “под риском/недостижима”.

### 2.2. Распределение свободных денег по приоритетам

- На каждый период (или день, но логика периодная):
  - считаем свободный кэш после обязательных расходов.
  - распределяем:
    1. Критичные цели (включая подушку, пока она не достигнута),
    2. Важные цели,
    3. Желаемые цели.
- Для каждой цели:
  - `Нужно: X ₽/период`, чтобы успеть к targetDate,
  - `План даёт: Y ₽/период` с учётом распределения,
  - статус:
    - `В графике` (Y ≥ X),
    - `Не успеваем: нужно +Z ₽/период` (Y < X).

### 2.3. Wishlist

- Хотелки получают деньги только из **остатка после**:
  - обязательных расходов,
  - подушки (если включена),
  - критичных и важных целей,
  - желаемых целей с датами (по логике).
- Для каждой хотелки считается ориентировочная дата, когда сумма `amount` может накопиться из этого остатка.

---

## 3. Интерфейс (высокоуровнево)

### 3.1. Вкладки

- Нижнее меню (TabBar):
  - `Цели` — список целей + summary по плану,
  - `Хотелки` — отдельный список wishlist,
  - `Доходы и расходы` — доходы, расходы, кредиты, вклады и рекомендации.

### 3.2. Экран «Цели»

- Summary-блок сверху:
  - `Свободно на цели: X ₽/месяц` (или единый выбранный период),
  - `Цели: N в графике, M под риском`,
  - `На хотелки остаётся: Y ₽/месяц` (если 0 — текст: «Сейчас всё уходит на обязательные платежи и цели»).
- Список целей:
  - название,
  - тип (иконка, напр. дом/подушка/самолёт),
  - приоритет (бейдж: Критичная/Важная/Желаемая),
  - прогресс,
  - прогнозируемая дата достижения,
  - блок:
    - `Нужно: X ₽/период`,
    - `План даёт: Y ₽/период`,
    - статус (зелёный/оранжевый).
- Подушка отображается как отдельная цель со своими показателями.

### 3.3. Экран «Хотелки»

- Короткое объяснение сверху:
  - «Здесь — то, что хочется купить.  
     Мы показываем, когда это можно сделать без вреда основным целям и подушке».
- Список:
  - название,
  - сумма,
  - ориентировочная дата “примерно с ДД.ММ.ГГ можно купить”.
- При создании цели **без даты** можно предлагать перенести её в хотeлки.

### 3.4. Экран «Доходы и расходы»

- Блок “Доходы”: оклад, доли аванс/зарплата, премии.
- Блок “Расходы”: категории + кредиты (с optional датой окончания).
- Блок “Вклады”:
  - `Обязательные`, `Фонд целей`, `Подушка` (если включена),
  - план / фактический остаток.
- Блок “Распределение дохода за период”:
  - доход периода,
  - рекомендации: сколько переложить в каждый “вклад” + оставить в кошельке,
  - внутри “Фонда целей” — сколько назначено на каждую цель.

---

## 4. Этапы развития (для понимания приоритета)

- **P0 (в работе)**:  
  подушка как цель + настройки, проверка дневного прогноза, приоритеты и “нужно/план даёт”, новый summary-блок на «Целях».
- **P1 (следующим этапом)**:  
  отдельный wishlist + вкладка «Хотелки», кредиты с optional конечной датой, тип цели «Путешествие».
- **P2 (позже)**:  
  полноценные “вклады” с ручным учётом остатков и рекомендациями, пуши и интеграции.

## 5. Ограничения

- Архитектура: SwiftUI + текущее хранение (UserDefaults/локально).
- Без внешних интеграций (банки, сети, LLM) на этом этапе.
- Важный акцент:  
  **простота интерфейса**, короткие тексты, минимум шагов до первой ценности (видимый план по целям).
